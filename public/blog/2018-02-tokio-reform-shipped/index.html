<!DOCTYPE html>
<html lang="en">
  <head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <link rel="apple-touch-icon" sizes="120x120" href="https://mindfreeze.videolan.me/rav1e/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://mindfreeze.videolan.me/rav1e/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://mindfreeze.videolan.me/rav1e/favicon-16x16.png">
    <link rel="manifest" href="https://mindfreeze.videolan.me/rav1e/manifest.json">
    <link rel="mask-icon" href="https://mindfreeze.videolan.me/rav1e/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#ffffff">

    
    <link rel="stylesheet" href="https://mindfreeze.videolan.me/rav1e/css/bootstrap-reboot.css">
    <link rel="stylesheet" href="https://mindfreeze.videolan.me/rav1e/css/bootstrap.css">
    <link rel="stylesheet" href="https://mindfreeze.videolan.me/rav1e/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://mindfreeze.videolan.me/rav1e/css/rav1e.css">

    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/>

    
    <link rel="alternate" type="application/rss+xml" href="https://tokio.rs/blog/index.xml" />

    <title>
      
        Tokio Reform is Shipped and the Road to 0.2 - rav1e
      
    </title>
  </head>
  <body>
    <header class="navbar navbar-expand navbar-dark flex-column flex-md-row tk-navbar">
      <a class="navbar-brand" href="https://mindfreeze.videolan.me/rav1e/">
        <img src="https://mindfreeze.videolan.me/rav1e/img/logo.png" class="align-middle" alt="">
      </a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link " href="https://mindfreeze.videolan.me/rav1e/">Home</a>
          </li>
          <li class="nav-item">
            
            
            
            <a class="nav-link " href="https://mindfreeze.videolan.me/rav1e/docs/getting-started/hello-world/">Documentation</a>
          </li>
          <li class="nav-item">
            
            <a class="nav-link " href="https://mindfreeze.videolan.me/rav1e/community/">Community</a>
          </li>
          <li class="nav-item">
            
            
            <a class="nav-link  active " href="https://mindfreeze.videolan.me/rav1e/blog/2018-12-recap-2018/">Blog</a>
          </li>
        </ul>
      </div>

      <ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex">
        <li class="nav-item">
          <a class="nav-link p-2" href="https://github.com/xiph/rav1e" target="_blank" rel="noopener" aria-label="GitHub">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 499.36" focusable="false"><title>GitHub</title><path d="M256 0C114.64 0 0 114.61 0 256c0 113.09 73.34 209 175.08 242.9 12.8 2.35 17.47-5.56 17.47-12.34 0-6.08-.22-22.18-.35-43.54-71.2 15.49-86.2-34.34-86.2-34.34-11.64-29.57-28.42-37.45-28.42-37.45-23.27-15.84 1.73-15.55 1.73-15.55 25.69 1.81 39.21 26.38 39.21 26.38 22.84 39.12 59.92 27.82 74.5 21.27 2.33-16.54 8.94-27.82 16.25-34.22-56.84-6.43-116.6-28.43-116.6-126.49 0-27.95 10-50.8 26.35-68.69-2.63-6.48-11.42-32.5 2.51-67.75 0 0 21.49-6.88 70.4 26.24a242.65 242.65 0 0 1 128.18 0c48.87-33.13 70.33-26.24 70.33-26.24 14 35.25 5.18 61.27 2.55 67.75 16.41 17.9 26.31 40.75 26.31 68.69 0 98.35-59.85 120-116.88 126.32 9.19 7.9 17.38 23.53 17.38 47.41 0 34.22-.31 61.83-.31 70.23 0 6.85 4.61 14.81 17.6 12.31C438.72 464.97 512 369.08 512 256.02 512 114.62 397.37 0 256 0z" fill="currentColor" fill-rule="evenodd"/></svg>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link p-2" href="https://gitter.im/tokio-rs/tokio" target="_blank" rel="noopener" aria-label="Gitter">
            <svg class="navbar-nav-svg" xmlns="http://www.w3.org/2000/svg" focusable="false"><title>Gitter</title><path fill="currentColor" d="M8.501 4.001H10.5V24H8.501V4.001zm6.999 0V24h-2V4.001h2zM3.5 0h2.001v15H3.5V0zm15 4.001h2V15h-2V4.001z"/></svg>
          </a>
        </li>
      </ul>
    </header>



<div class="container-fluid tk-blog">
  <div class="row flex-xl-nowrap">
    <div class="col-12 col-md-3 col-xl-2 tk-sidebar">
      
      <div class="tk-docs-toggle d-md-none p-0 d-flex ml-3 collapsed align-item-center">
        <h1 class="tk-title">Tokio Reform is Shipped and the Road to 0.2</h1>
        <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#tk-docs-nav" aria-controls="tk-docs-nav" aria-expanded="false" aria-label="Toggle docs navigation">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30" width="30" height="30" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-miterlimit="10" d="M4 7h22M4 15h22M4 23h22"></path></svg>
        </button>
      </div>
      <nav class="tk-links collapse" id="tk-docs-nav">
          <div class="tk-toc-item active">
            <p class="tk-toc-link">
              Blog Posts
            </p>
            <ul class="nav tk-sidenav">
              
              
                  <li><a href="https://mindfreeze.videolan.me/rav1e/blog/2018-12-recap-2018/" class="">A great 2018, an even better 2019</a></li>
              
                  <li><a href="https://mindfreeze.videolan.me/rav1e/blog/2018-10-doc-blitz/" class="">Announcing the Tokio Doc Push (we need you!)</a></li>
              
                  <li><a href="https://mindfreeze.videolan.me/rav1e/blog/2018-08-async-await/" class="">Experimental async / await support for Tokio</a></li>
              
                  <li><a href="https://mindfreeze.videolan.me/rav1e/blog/2018-08-incremental-improvements/" class="">Tokio 0.1.8 with many incremental improvements</a></li>
              
                  <li><a href="https://mindfreeze.videolan.me/rav1e/blog/2018-05-tokio-fs/" class="">New Tokio release, now with filesystem support</a></li>
              
                  <li><a href="https://mindfreeze.videolan.me/rav1e/blog/2018-03-timers/" class="">New Timer implementation</a></li>
              
                  <li><a href="https://mindfreeze.videolan.me/rav1e/blog/2018-03-tokio-runtime/" class="">Announcing the Tokio runtime</a></li>
              
                  <li><a href="https://mindfreeze.videolan.me/rav1e/blog/2018-02-tokio-reform-shipped/" class="active">Tokio Reform is Shipped and the Road to 0.2</a></li>
              
                  <li><a href="https://mindfreeze.videolan.me/rav1e/blog/2017-09-tokio-reform/" class="">An RFC for a Tokio revamp</a></li>
              
                  <li><a href="https://mindfreeze.videolan.me/rav1e/blog/2017-03-tokio-io/" class="">Announcing the tokio-io Crate</a></li>
              
                  <li><a href="https://mindfreeze.videolan.me/rav1e/blog/2017-01-tokio-0-1/" class="">Announcing Tokio 0.1</a></li>
              
            </ul>
          </div>
      </nav>
    </div>
    <div class="d-none d-xl-block col-xl-2 tk-toc">
      <div class="section-nav">
        <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#the-new-global-event-loop">The new global event loop</a></li>
<li><a href="#the-road-to-0-2">The road to 0.2</a></li>
<li><a href="#rapid-iteration">Rapid iteration</a></li>
<li><a href="#open-question">Open question</a></li>
<li><a href="#looking-forward">Looking Forward</a></li>
</ul></li>
</ul>
</nav>
      </div>

    </div>
    <main class="col-12 col-md-9 col-xl-8 py-md-3 pl-md-5 tk-content tk-docs">
      <h1 class="tk-title">Tokio Reform is Shipped and the Road to 0.2</h1>
      <p class="tk-date">07 February 2018</p>
      
      

<p>Hi all!</p>

<p>I&rsquo;m happy to announce that today, the changes proposed in the <a href="https://github.com/tokio-rs/tokio-rfcs/blob/master/text/0001-tokio-reform.md">reform RFC</a> have
been released to <a href="https://crates.io/crates/tokio">crates.io</a> as <code>tokio</code> 0.1.</p>

<p>The primary changes are:</p>

<ul>
<li><p>Add a <em>default</em> global event loop, eliminating the need for setting up and
managing your own event loop in the vast majority of cases.</p></li>

<li><p>Decouple all task execution functionality from Tokio.</p></li>
</ul>

<h2 id="the-new-global-event-loop">The new global event loop</h2>

<p>Up until today, creating an event loop was a manual process. Even though the
vast majority of Tokio users would setup the reactor to do the same thing,
everyone had to do it each time. This was partially due to the fact that there
was a significant difference between running code on the Tokio reactor&rsquo;s thread
or from another thread (like a thread pool).</p>

<p>The key insight that allowed for the Tokio reform changes is that the Tokio
reactor doesn&rsquo;t actually have to be an executor. In other words, prior to these
changes, the Tokio reactor would both power I/O resources <strong>and</strong> manage
executing user submitted tasks.</p>

<p>Now, Tokio provides a reactor to drive I/O resources (like <code>TcpStream</code> and
<code>UdpSocket</code>) separately from the task executor. This means that it is easy to
create Tokio-backed networking types from <em>any</em> thread, making it easy to create
either single or multi threaded Tokio-backed apps.</p>

<p>For task execution, Tokio provides the <a href="https://docs.rs/tokio-current-thread"><code>current_thread</code></a> executor, which
behaves similarly to how the built-in tokio-core executor did. The plan is to
eventually move this executor into the <a href="https://github.com/rust-lang-nursery/futures-rs"><code>futures</code></a> crate, but for now it is
provided directly by Tokio.</p>

<h2 id="the-road-to-0-2">The road to 0.2</h2>

<p>The Tokio reform changes have been released as 0.1. Dependencies (<a href="https://github.com/tokio-rs/tokio-io"><code>tokio-io</code></a>,
<a href="https://github.com/rust-lang-nursery/futures-rs"><code>futures</code></a>, <a href="https://github.com/carllerche/mio"><code>mio</code></a>, etc&hellip;) have not had their versions incremented. This
allows the <code>tokio</code> crate to be released with minimal ecosystem disruption.</p>

<p>The plan is to let the changes made in this release get some usage before
committing to them. Any fixes that require breaking changes will be able to be
done at the same time as the release to all the other crates. The goal is for
this to happen in 6-8 weeks. So please try out the changes released today and
provide feedback.</p>

<h2 id="rapid-iteration">Rapid iteration</h2>

<p>This is just the beginning. Tokio has ambitious goals to provide additional
functionality to get a great &ldquo;out of the box&rdquo; experience building asynchronous
I/O applications in Rust.</p>

<p>In order to reach these goals as fast as possible without causing unnecessary
ecosystem disruption, we will be taking a few steps.</p>

<p>First, similarly to the <a href="#"><code>futures</code> 0.2 release</a>, the <code>tokio</code> crate will be
transitioned to be more of a facade. Traits and types will be broken up into a
number of sub crates and re-exported by <code>tokio</code>. Application authors will be
able to depend directly on <code>tokio</code> while library authors will pick and choose
the specific Tokio components that they wish to use as part of their libraries.</p>

<p>Each sub crate will clearly indicate its stability level. Obviously, there is an
upcoming breaking change with the futures 0.2 release, but after that,
fundamental building blocks will aim to remain stable for at least a year. More
experimental crates will reserve the right to issue breaking changes at a
quicker pace.</p>

<p>This means that the <code>tokio</code> crate itself will be able to iterate at a faster
pace while the library ecosystem remains stable.</p>

<p>The pre 0.2 period will also be a period of experimentation. Additional
functionality will be added to Tokio in an experimental capacity. Before an 0.2
release, an RFC will be posted covering the functionality that we would like to
include in that release.</p>

<h2 id="open-question">Open question</h2>

<p>One remaining question is what to do about <code>tokio-proto</code>. It was released as
part of the initial Tokio release. Since then, the focus has shifted and that
crate has not received enough attention.</p>

<p>I posted an issue to discuss what to do with that crate
<a href="https://github.com/tokio-rs/tokio/issues/118">here</a></p>

<h2 id="looking-forward">Looking Forward</h2>

<p>Please try out the changes released today. Again, the next couple of months are a period
of experimentation before we commit on the next release. So, now is the time to try things
out and provide feedback.</p>

<p>During this time, we&rsquo;ll be integrating this work to build out higher-level
primitives in <a href="https://github.com/tower-rs/tower">Tower</a>, which is being driven by the production operational needs
of the <a href="https://github.com/runconduit/conduit">Conduit</a> project.</p>

<div style="text-align:right">&mdash;Carl Lerche</div>

      

      
        <div class="tk-next">
          <b>Next up</b>: <a href ="/blog/2018-03-tokio-runtime/">Announcing the Tokio runtime</a>
        </div>
      
    </main>
  </div>
</div>

    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha384-3ceskX3iaEnIogmQchP8opvBy3Mi7Ce34nWjpBIwVTHfGYWQS9jwHDVRnpKKHJg7" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.7/js/tether.min.js" integrity="sha384-XTs3FgkjiBgo8qjEjBk0tGmf3wPrWtA6coPfQDfFEY8AnYJwjalXCiosYRBIBZX8" crossorigin="anonymous"></script>
    <script src="https://mindfreeze.videolan.me/rav1e/js/bootstrap.min.js"></script>
    <script src="https://mindfreeze.videolan.me/rav1e/js/highlight.js"></script>
    <script>
      $(function () {
        $("pre code").each(function(i, block) {
          
          if (block.className.indexOf('language-rust') >= 0) {
            var new_content = '';
            var lines = block.textContent.split('\n');
            for (var i = 0; i < lines.length; i++) {
              if (lines[i].indexOf('# ') == 0 || lines[i] == '#') {
                continue
              }
              new_content += lines[i].trimRight() + '\n';
            }
            block.textContent = new_content.replace(/\n\n\n/g, "\n\n").trimRight();
          }
          hljs.highlightBlock(block);
        });
      });
    </script>
    
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
    <script type="text/javascript"> docsearch({
    apiKey: 'd7b5b785798fe748621bcaa8301a2201',
    indexName: 'tokio',
    inputSelector: '#search-input',
    debug: false 
    });
    </script>
    
  </body>
</html>

